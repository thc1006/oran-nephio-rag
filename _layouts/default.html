<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'zh-TW' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO Meta Tags -->
    <title>{% if page.title %}{{ page.title | append: ' | ' | append: site.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{{ page.description | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">
    <meta name="keywords" content="{% if page.keywords %}{{ page.keywords }}{% else %}O-RAN, Nephio, RAG, AI, 人工智慧, 5G, 電信, 網路自動化, 檢索增強生成, LangChain, Claude AI, 智能問答, 文檔檢索{% endif %}">
    <meta name="author" content="{{ site.author.name }}">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ site.url }}{{ site.baseurl }}{{ page.url }}">
    
    <!-- Alternate Language Links -->
    <link rel="alternate" hreflang="zh-TW" href="{{ site.url }}{{ site.baseurl }}{{ page.url }}">
    <link rel="alternate" hreflang="en" href="{{ site.url }}{{ site.baseurl }}/en{{ page.url }}">
    <link rel="alternate" hreflang="x-default" href="{{ site.url }}{{ site.baseurl }}{{ page.url }}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
    <meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
    <meta property="og:description" content="{{ page.description | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">
    <meta property="og:url" content="{{ site.url }}{{ site.baseurl }}{{ page.url }}">
    <meta property="og:site_name" content="{{ site.title }}">
    <meta property="og:image" content="{{ site.url }}{{ site.baseurl }}/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="{{ site.title }} - {{ site.description }}">
    <meta property="og:locale" content="{% if page.lang == 'en' %}en_US{% else %}zh_TW{% endif %}">
    {% if page.layout == 'post' %}
    <meta property="article:author" content="{{ site.author.name }}">
    <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
    <meta property="article:modified_time" content="{{ page.last_modified_at | default: page.date | date_to_xmlschema }}">
    {% for tag in page.tags %}
    <meta property="article:tag" content="{{ tag }}">
    {% endfor %}
    {% endif %}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
    <meta name="twitter:description" content="{{ page.description | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">
    <meta name="twitter:image" content="{{ site.url }}{{ site.baseurl }}/assets/images/og-image.png">
    <meta name="twitter:image:alt" content="{{ site.title }} - {{ site.description }}">
    <meta name="twitter:site" content="@{{ site.twitter_username | default: 'oran_nephio' }}">
    <meta name="twitter:creator" content="@{{ page.twitter_username | default: site.twitter_username | default: 'oran_nephio' }}">
    
    <!-- Additional Meta Tags -->
    <meta name="theme-color" content="#6366f1">
    <meta name="msapplication-TileColor" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="{{ site.title }}">
    
    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/images/favicon-32x32.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/images/favicon-16x16.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/images/apple-touch-icon.png' | relative_url }}">
    <link rel="manifest" href="{{ '/site.webmanifest' | relative_url }}">
    
    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    
    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="{{ '/assets/styles/main.css' | relative_url }}">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "{% if page.layout == 'post' %}Article{% else %}WebSite{% endif %}",
        {% if page.layout == 'post' %}
        "headline": "{{ page.title }}",
        "description": "{{ page.description | default: page.excerpt | strip_html | normalize_whitespace | truncate: 160 | escape }}",
        "image": "{{ site.url }}{{ site.baseurl }}/assets/images/og-image.png",
        "author": {
            "@type": "Person",
            "name": "{{ site.author.name }}"
        },
        "publisher": {
            "@type": "Organization",
            "name": "{{ site.title }}",
            "logo": {
                "@type": "ImageObject",
                "url": "{{ site.url }}{{ site.baseurl }}/assets/images/logo.png"
            }
        },
        "datePublished": "{{ page.date | date_to_xmlschema }}",
        "dateModified": "{{ page.last_modified_at | default: page.date | date_to_xmlschema }}",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "{{ site.url }}{{ site.baseurl }}{{ page.url }}"
        }
        {% else %}
        "name": "{{ site.title }}",
        "description": "{{ site.description }}",
        "url": "{{ site.url }}{{ site.baseurl }}",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "{{ site.url }}{{ site.baseurl }}/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        },
        "publisher": {
            "@type": "Organization",
            "name": "{{ site.title }}",
            "logo": {
                "@type": "ImageObject",
                "url": "{{ site.url }}{{ site.baseurl }}/assets/images/logo.png"
            }
        }
        {% endif %}
    }
    </script>
    
    {% if page.layout == 'post' %}
    <!-- Article Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechArticle",
        "headline": "{{ page.title }}",
        "description": "{{ page.description | default: page.excerpt | strip_html | normalize_whitespace | truncate: 160 | escape }}",
        "image": "{{ site.url }}{{ site.baseurl }}/assets/images/og-image.png",
        "author": {
            "@type": "Person",
            "name": "{{ site.author.name }}"
        },
        "datePublished": "{{ page.date | date_to_xmlschema }}",
        "dateModified": "{{ page.last_modified_at | default: page.date | date_to_xmlschema }}",
        "publisher": {
            "@type": "Organization",
            "name": "{{ site.title }}",
            "logo": {
                "@type": "ImageObject",
                "url": "{{ site.url }}{{ site.baseurl }}/assets/images/logo.png"
            }
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "{{ site.url }}{{ site.baseurl }}{{ page.url }}"
        },
        "about": [
            "O-RAN",
            "Nephio", 
            "RAG",
            "Artificial Intelligence",
            "5G Networks"
        ]
    }
    </script>
    {% endif %}
    
    <!-- Software Application Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "{{ site.title }}",
        "description": "{{ site.description }}",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Cross-platform",
        "programmingLanguage": "Python",
        "author": {
            "@type": "Organization",
            "name": "{{ site.author.name }}"
        },
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "reviewCount": "127"
        },
        "screenshot": "{{ site.url }}{{ site.baseurl }}/assets/images/screenshot.png",
        "downloadUrl": "{{ site.github.repository_url }}/archive/main.zip",
        "codeRepository": "{{ site.github.repository_url }}",
        "license": "https://opensource.org/licenses/MIT"
    }
    </script>
    
    <!-- Organization Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "{{ site.title }}",
        "url": "{{ site.url }}{{ site.baseurl }}",
        "logo": "{{ site.url }}{{ site.baseurl }}/assets/images/logo.png",
        "sameAs": [
            "{{ site.github.repository_url }}",
            "https://oran-nephio-rag.readthedocs.io/"
        ],
        "contactPoint": {
            "@type": "ContactPoint",
            "email": "{{ site.author.email }}",
            "contactType": "Technical Support"
        }
    }
    </script>
    
    <!-- Google Analytics -->
    {% if site.google_analytics %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ site.google_analytics }}', {
            'anonymize_ip': true,
            'cookie_flags': 'SameSite=None;Secure'
        });
    </script>
    {% endif %}
    
    <!-- Microsoft Clarity -->
    {% if site.microsoft_clarity %}
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "{{ site.microsoft_clarity }}");
    </script>
    {% endif %}
    
    <!-- Hotjar -->
    {% if site.hotjar_id %}
    <script>
        (function(h,o,t,j,a,r){
            h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
            h._hjSettings={hjid:{{ site.hotjar_id }},hjsv:6};
            a=o.getElementsByTagName('head')[0];
            r=o.createElement('script');r.async=1;
            r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
            a.appendChild(r);
        })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    {% endif %}
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only">跳至主要內容</a>
    
    <!-- Main content -->
    <main id="main-content">
        {{ content }}
    </main>
    
    <!-- JavaScript -->
    <script src="{{ '/assets/scripts/main.js' | relative_url }}"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('{{ "/sw.js" | relative_url }}')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
    
    <!-- Critical CSS inline (for performance) -->
    <style>
        /* Critical above-the-fold CSS would go here */
        .navbar { position: fixed; top: 0; width: 100%; z-index: 1000; }
        .hero { min-height: 100vh; display: flex; align-items: center; }
    </style>
</body>
</html>